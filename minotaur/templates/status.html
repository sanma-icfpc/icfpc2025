{% from "_task_card.html" import task_card %}
<div id="status" class="space-y-6">
  <!-- Running Card -->
  <div id="section-running" class="bg-white border rounded p-4 relative">
    <h3 class="font-semibold mb-2">Running</h3>
    {% if running %}
      {{ task_card('running', running, running_flows) }}
    {% else %}
      <div class="text-sm text-gray-500">None</div>
    {% endif %}
  </div>
  <!-- Queued Cards -->
  <div id="section-queued" class="bg-white border rounded p-4">
    <h3 class="font-semibold mb-2">Queued</h3>
    {% if queued %}
      <div class="grid grid-cols-1 gap-2">
        {% for t in queued %}
          {{ task_card('queued', t, queued_flows.get(t.id)) }}
        {% endfor %}
      </div>
    {% else %}
      <div class="text-sm text-gray-500">None</div>
    {% endif %}
  </div>

  <!-- Recent Cards -->
  <div id="section-recent" class="bg-white border rounded p-4">
    <div class="flex items-center justify-between mb-2">
      <div class="flex items-center gap-3">
        <h3 class="font-semibold">Recent</h3>
        <div class="text-sm flex items-center gap-2">
          <input id="recent-filter-input" type="text" class="border rounded px-2 py-1 w-64" placeholder="Filter by agent or problem" value="{{ recent_filter or '' }}" />
        </div>
      </div>
      <div id="recent-pager" class="text-sm flex items-center gap-2" data-page="{{ recent_page or 1 }}" data-pages="{{ recent_pages or 1 }}">
        <button class="px-2 py-1 rounded bg-gray-200 disabled:opacity-50" onclick="recentPrev()" {% if (recent_page or 1) <= 1 %}disabled{% endif %}>Prev</button>
        <span class="text-gray-500">Page</span>
        <input id="recent-page-input" name="page" type="number" min="1" class="border rounded px-2 py-1 w-16 text-center" value="{{ recent_page or 1 }}" />
        <span class="text-gray-500">/ {{ recent_pages or 1 }}</span>
        <button class="px-2 py-1 rounded bg-gray-200 disabled:opacity-50" onclick="recentNext()" {% if (recent_page or 1) >= (recent_pages or 1) %}disabled{% endif %}>Next</button>
      </div>
    </div>
    <div class="mt-1">
      {% if recent %}
        <div class="grid grid-cols-1 gap-2">
          {% for t in recent %}
            {{ task_card('recent', t, recent_flows.get(t.id)) }}
          {% endfor %}
        </div>
      {% else %}
        <div class="text-sm text-gray-500">None</div>
      {% endif %}
    </div>
  </div>
</div>
